<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <title>DFS ìˆœì—´ íŠ¸ë¦¬ (ê²¹ì¹¨ í•´ê²° ë²„ì „)</title>
        <style>
            body {
                font-family: "Pretendard", sans-serif;
                background: #f8f9fa;
                display: flex;
                flex-direction: column;
                align-items: center;
                padding: 20px;
            }
            .controls {
                margin-bottom: 20px;
            }
            button {
                padding: 12px 24px;
                border-radius: 8px;
                border: none;
                background: #2f3542;
                color: white;
                cursor: pointer;
                font-weight: bold;
            }
            canvas {
                background: white;
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            }
            .info {
                margin-top: 15px;
                background: #2f3542;
                color: white;
                padding: 15px;
                border-radius: 10px;
                width: 1000px;
                font-family: monospace;
                font-size: 14px;
            }
        </style>
    </head>
    <body>
        <h2>ğŸŒ³ DFS ìˆœì—´ íŠ¸ë¦¬ (6ê°œ ê²°ê³¼ ì™„ë²½ ì‹œê°í™”)</h2>
        <div class="controls">
            <button id="startBtn" style="background: #2ed573">
                ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘
            </button>
            <button onclick="location.reload()" style="background: #747d8c">
                ì´ˆê¸°í™”
            </button>
        </div>

        <canvas id="treeCanvas" width="1100" height="600"></canvas>

        <div class="info" id="status">
            [ì‹œì‘]ì„ ëˆ„ë¥´ë©´ 6ê°œì˜ ìˆœì—´ì´ ê²¹ì¹˜ì§€ ì•Šê²Œ ìƒì„±ë©ë‹ˆë‹¤.
        </div>

        <script>
            const canvas = document.getElementById("treeCanvas");
            const ctx = canvas.getContext("2d");
            const status = document.getElementById("status");

            const arr = ["A", "B", "C"];
            const n = 3,
                r = 2;
            let visited = [false, false, false];
            const sleep = (ms) => new Promise((res) => setTimeout(res, ms));

            function drawNode(x, y, path, currentVisited, isComplete) {
                const radius = 28;

                // 1. ì›í˜• ë…¸ë“œ ê·¸ë¦¬ê¸°
                ctx.beginPath();
                ctx.arc(x, y, radius, 0, Math.PI * 2);
                ctx.fillStyle = isComplete ? "#2ed573" : "#ffffff";
                ctx.fill();
                ctx.strokeStyle = isComplete ? "#15b04a" : "#4834d4";
                ctx.lineWidth = 3;
                ctx.stroke();

                // 2. ê²½ë¡œ í…ìŠ¤íŠ¸
                ctx.fillStyle = isComplete ? "white" : "#2d3436";
                ctx.font = "bold 14px sans-serif";
                ctx.textAlign = "center";
                ctx.fillText(path.length ? path.join("") : "Root", x, y + 5);

                // 3. isVisited ìƒíƒœ (ë…¸ë“œ ë°”ë¡œ ì•„ë˜ ì‘ê²Œ í‘œì‹œ)
                const vSize = 10;
                const vGap = 3;
                const startX = x - (vSize * 3 + vGap * 2) / 2;

                arr.forEach((char, i) => {
                    ctx.fillStyle = currentVisited[i] ? "#ff4757" : "#dfe6e9";
                    ctx.fillRect(
                        startX + i * (vSize + vGap),
                        y + 35,
                        vSize,
                        vSize
                    );
                    ctx.fillStyle = currentVisited[i] ? "white" : "#636e72";
                    ctx.font = "8px sans-serif";
                    ctx.fillText(
                        char,
                        startX + i * (vSize + vGap) + vSize / 2,
                        y + 43
                    );
                });
            }

            function drawLine(x1, y1, x2, y2) {
                ctx.beginPath();
                ctx.moveTo(x1, y1 + 30);
                ctx.lineTo(x2, y2 - 30);
                ctx.strokeStyle = "#ced4da";
                ctx.lineWidth = 2;
                ctx.stroke();
            }

            async function dfs(depth, path, x, y, widthRange) {
                drawNode(x, y, path, [...visited], depth === r);

                if (depth === r) {
                    await sleep(1000);
                    return;
                }

                // í˜„ì¬ ë…¸ë“œì—ì„œ ë°©ë¬¸ ê°€ëŠ¥í•œ ìì‹ë“¤ ì°¾ê¸°
                let candidates = [];
                for (let i = 0; i < n; i++) {
                    if (!visited[i]) candidates.push(i);
                }

                // ìì‹ë“¤ì´ ì°¨ì§€í•  ì˜ì—­ì„ ë“±ë¶„í•˜ì—¬ ì¢Œí‘œ ê³„ì‚°
                const childCount = candidates.length;
                const segment = widthRange / childCount;

                for (let idx = 0; idx < childCount; idx++) {
                    const i = candidates[idx];

                    visited[i] = true;
                    path.push(arr[i]);

                    // ê²¹ì¹¨ ë°©ì§€ í•µì‹¬: ë¶€ëª¨ê°€ ê°€ì§„ ì˜ì—­(widthRange) ë‚´ì—ì„œ ìì‹ ìˆ˜ë§Œí¼ ë“±ë¶„í•˜ì—¬ ë°°ì¹˜
                    const nextX =
                        x - widthRange / 2 + segment * idx + segment / 2;
                    const nextY = y + 150;

                    drawLine(x, y, nextX, nextY);
                    await sleep(700);

                    // ë‹¤ìŒ ì¸µì€ ìì‹ì´ ì‚¬ìš©í•  ì˜ì—­ì„ ë‹¤ì‹œ ì¤„ì—¬ì„œ ì „ë‹¬
                    await dfs(depth + 1, path, nextX, nextY, segment);

                    path.pop();
                    visited[i] = false;

                    // ë°±íŠ¸ë˜í‚¹ í›„ ìƒíƒœ ì—…ë°ì´íŠ¸
                    drawNode(x, y, path, [...visited], false);
                    await sleep(300);
                }
            }

            document.getElementById("startBtn").onclick = async () => {
                document.getElementById("startBtn").disabled = true;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                // ì „ì²´ ê°€ë¡œ í­ 1000ì„ ê¸°ì¤€ìœ¼ë¡œ ì‹œì‘
                await dfs(0, [], canvas.width / 2, 80, 1000);
                status.innerHTML =
                    "âœ¨ <b>íƒìƒ‰ ì™„ë£Œ!</b> 6ê°œì˜ ìˆœì—´ì´ ê²¹ì¹¨ ì—†ì´ ëª¨ë‘ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.";
            };
        </script>
    </body>
</html>
